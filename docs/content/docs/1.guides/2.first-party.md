---
title: First-Party Mode
description: Route third-party script traffic through your domain for improved privacy and reliability.
---

## Background

When third-party scripts load directly from external servers, they expose your users' data:

- **IP address exposure** - Every request reveals your users' IP addresses to third parties
- **Third-party cookies** - External scripts can set cookies for cross-site tracking
- **Ad blocker interference** - Privacy tools block requests to known tracking domains
- **Connection overhead** - Extra DNS lookups and TLS handshakes slow page loads

### How First-Party Mode Helps

First-party mode routes all script traffic through your domain:

- **User IPs stay private** - Third parties see your server's IP, not your users'
- **No third-party cookies** - Requests are same-origin, eliminating cross-site tracking
- **Works with ad blockers** - Requests appear first-party
- **Faster loads** - No extra DNS lookups for external domains

## How it Works

When first-party mode is enabled:

1. **Build time**: Scripts are downloaded and URLs are rewritten to local paths (e.g., `https://www.google-analytics.com/g/collect` → `/_scripts/c/ga/g/collect`)
2. **Runtime**: Nitro route rules proxy requests from local paths back to original endpoints

```
User Browser → Your Server (/_scripts/c/ga/...) → Google Analytics
```

Your users never connect directly to third-party servers.

## Usage

### Enable Globally

Enable first-party mode for all supported scripts:

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  scripts: {
    firstParty: true,
    registry: {
      googleAnalytics: { id: 'G-XXXXXX' },
      metaPixel: { id: '123456' },
    }
  }
})
```

### Custom Paths

Customize the proxy endpoint paths:

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  scripts: {
    firstParty: {
      collectPrefix: '/_analytics', // Default: /_scripts/c
    }
  }
})
```

### Opt-out Per Script

Disable first-party routing for a specific script:

```ts
useScriptGoogleAnalytics({
  id: 'G-XXXXXX',
  scriptOptions: {
    firstParty: false, // Load directly from Google
  }
})
```

## Supported Scripts

First-party mode supports the following scripts:

| Script | Endpoints Routed |
|--------|------------------|
| Google Analytics | `www.google.com/g/collect`, `www.google-analytics.com` |
| Google Tag Manager | `www.googletagmanager.com` |
| Meta Pixel | `connect.facebook.net`, `www.facebook.com/tr` |
| TikTok Pixel | `analytics.tiktok.com` |
| Segment | `api.segment.io`, `cdn.segment.com` |
| Microsoft Clarity | `www.clarity.ms` |
| Hotjar | `static.hotjar.com`, `vars.hotjar.com` |
| X/Twitter Pixel | `analytics.twitter.com`, `t.co` |
| Snapchat Pixel | `tr.snapchat.com` |
| Reddit Pixel | `alb.reddit.com` |

## Requirements

First-party mode requires a **server runtime**. It won't work with fully static hosting (e.g., `nuxt generate` to GitHub Pages) because the proxy endpoints need a server to forward requests.

For static deployments, you can still enable first-party mode - scripts will be bundled with rewritten URLs, but you'll need to configure your hosting platform's rewrite rules manually.

### Static Hosting Rewrites

If deploying statically, configure your platform to proxy these paths:

```
/_scripts/c/ga/* → https://www.google.com/*
/_scripts/c/gtm/* → https://www.googletagmanager.com/*
/_scripts/c/meta/* → https://connect.facebook.net/*
```

## First-Party vs Bundle

First-party mode supersedes the `bundle` option:

| Feature | `bundle: true` | `firstParty: true` |
|---------|---------------|-------------------|
| Downloads script at build | ✅ | ✅ |
| Serves from your domain | ✅ | ✅ |
| Rewrites collection URLs | ❌ | ✅ |
| Proxies API requests | ❌ | ✅ |
| Hides user IPs | ❌ | ✅ |
| Blocks third-party cookies | ❌ | ✅ |

The `bundle` option only self-hosts the script file. First-party mode also rewrites and proxies all collection/tracking endpoints, providing complete first-party routing.

::callout{type="warning"}
The `bundle` option is deprecated. Use `firstParty: true` for new projects.
::
